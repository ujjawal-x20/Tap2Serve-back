<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Tap2Serve</title>
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1"
        rel="stylesheet" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#c9a24d",
                        "primary-dark": "#a08036",
                        "bg-deep": "#0b0b0b",
                        "bg-soft": "#1a1a1a",
                        "bg-card": "#141414",
                        "text-main": "#ffffff",
                        "text-muted": "#b5b5b5",
                    },
                    fontFamily: {
                        sans: ["Inter", "sans-serif"],
                    },
                    boxShadow: {
                        'glow': '0 0 20px rgba(201, 162, 77, 0.1)',
                    }
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0b0b0b;
            color: #fff;
        }

        .glass-panel {
            background: rgba(26, 26, 26, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .sidebar-link {
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .sidebar-link:hover,
        .sidebar-link.active {
            background: rgba(201, 162, 77, 0.1);
            color: #c9a24d;
            border-right: 3px solid #c9a24d;
        }

        .sidebar-link.active i {
            color: #c9a24d;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #0b0b0b;
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #c9a24d;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
            border-color: rgba(201, 162, 77, 0.3);
        }

        /* View transition */
        .view-section {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }

        .view-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="flex h-screen overflow-hidden selection:bg-primary selection:text-black">

    <!-- SIDEBAR -->
    <aside class="w-64 bg-bg-soft border-r border-white/5 flex flex-col hidden md:flex">
        <div class="h-20 flex items-center px-8 border-b border-white/5">
            <span class="material-symbols-outlined text-primary text-3xl mr-2">restaurant_menu</span>
            <h1 class="text-xl font-bold tracking-tight text-white">Tap2Serve</h1>
        </div>

        <nav class="flex-1 py-8 flex flex-col gap-1">
            <div class="px-4 mb-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">Main</div>

            <a onclick="switchTab('dashboard')" id="nav-dashboard"
                class="sidebar-link active flex items-center gap-4 px-8 py-3 text-sm font-medium text-gray-300">
                <span class="material-symbols-outlined text-[20px]">dashboard</span>
                Dashboard
            </a>
            <a onclick="switchTab('orders')" id="nav-orders"
                class="sidebar-link flex items-center gap-4 px-8 py-3 text-sm font-medium text-gray-300">
                <span class="material-symbols-outlined text-[20px]">orders</span>
                Live Orders
                <span class="ml-auto text-[10px] bg-primary text-black font-bold px-2 py-0.5 rounded-full">12</span>
            </a>
            <a onclick="switchTab('menu')" id="nav-menu"
                class="sidebar-link flex items-center gap-4 px-8 py-3 text-sm font-medium text-gray-300">
                <span class="material-symbols-outlined text-[20px]">menu_book</span>
                Menu Management
            </a>
            <a onclick="switchTab('tables')" id="nav-tables"
                class="sidebar-link flex items-center gap-4 px-8 py-3 text-sm font-medium text-gray-300">
                <span class="material-symbols-outlined text-[20px]">table_bar</span>
                Tables & Zones
            </a>

            <div class="px-4 mt-8 mb-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">Analytics</div>
            <a onclick="switchTab('reports')" id="nav-reports"
                class="sidebar-link flex items-center gap-4 px-8 py-3 text-sm font-medium text-gray-300">
                <span class="material-symbols-outlined text-[20px]">monitoring</span>
                Sales Reports
            </a>
            <a onclick="switchTab('transactions')" id="nav-transactions"
                class="sidebar-link flex items-center gap-4 px-8 py-3 text-sm font-medium text-gray-300">
                <span class="material-symbols-outlined text-[20px]">receipt_long</span>
                Transactions
            </a>
        </nav>

        <div class="p-4 border-t border-white/5">
            <a href="index.html"
                class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-white/5 transition-colors text-sm text-gray-400 hover:text-white">
                <span class="material-symbols-outlined">logout</span>
                Sign Out
            </a>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 flex flex-col min-w-0 overflow-hidden bg-bg-deep relative">
        <!-- Background Glow -->
        <div
            class="absolute top-0 right-0 w-[500px] h-[500px] bg-primary/5 rounded-full blur-[120px] pointer-events-none">
        </div>

        <!-- HEADER -->
        <header
            class="h-20 border-b border-white/5 flex items-center justify-between px-8 bg-bg-deep/50 backdrop-blur-md z-10">
            <h2 id="page-title" class="text-xl font-semibold text-white">Overview</h2>

            <div class="flex items-center gap-6">
                <!-- Search -->
                <div class="relative hidden md:block">
                    <span
                        class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-lg">search</span>
                    <input type="text" placeholder="Search..."
                        class="bg-bg-soft border border-white/10 rounded-full pl-10 pr-4 py-2 text-sm text-gray-300 focus:outline-none focus:border-primary/50 w-64 transition-colors">
                </div>

                <!-- Icons -->
                <button class="relative text-gray-400 hover:text-white transition-colors">
                    <span class="material-symbols-outlined">notifications</span>
                    <span class="absolute top-0 right-0 size-2 bg-red-500 rounded-full border border-bg-deep"></span>
                </button>

                <!-- Profile -->
                <div class="flex items-center gap-3 pl-6 border-l border-white/5">
                    <div class="text-right hidden md:block">
                        <p class="text-sm font-medium text-white">Restaurant Manager</p>
                        <p class="text-xs text-primary">Admin</p>
                    </div>
                    <div class="size-10 rounded-full bg-gradient-to-tr from-primary to-primary-dark p-[2px]">
                        <img src="https://ui-avatars.com/api/?name=Admin+User&background=0b0b0b&color=fff"
                            class="rounded-full w-full h-full object-cover border-2 border-bg-deep">
                    </div>
                </div>
            </div>
        </header>

        <!-- SCROLLABLE CONTENT AREA -->
        <div class="flex-1 overflow-y-auto p-4 md:p-8 scroll-smooth relative">

            <!-- ================= VIEW: DASHBOARD ================= -->
            <div id="view-dashboard" class="view-section active">
                <!-- STATS GRID -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Stat 1 -->
                    <!-- Stat 1 -->
                    <div class="glass-panel p-6 rounded-2xl stat-card transition-all duration-300">
                        <div class="flex justify-between items-start mb-4">
                            <div class="p-2 bg-primary/10 rounded-lg text-primary">
                                <span class="material-symbols-outlined">payments</span>
                            </div>
                            <span class="text-green-500 text-xs font-bold flex items-center">
                                +12.5% <span class="material-symbols-outlined text-[14px]">arrow_upward</span>
                            </span>
                        </div>
                        <h3 class="text-gray-400 text-sm font-medium">Total Revenue</h3>
                        <p id="stat-revenue" class="text-2xl font-bold text-white mt-1">₹...</p>
                    </div>
                    <!-- Stat 2 -->
                    <div class="glass-panel p-6 rounded-2xl stat-card transition-all duration-300">
                        <div class="flex justify-between items-start mb-4">
                            <div class="p-2 bg-blue-500/10 rounded-lg text-blue-500">
                                <span class="material-symbols-outlined">shopping_bag</span>
                            </div>
                            <span class="text-green-500 text-xs font-bold flex items-center">
                                +8.2% <span class="material-symbols-outlined text-[14px]">arrow_upward</span>
                            </span>
                        </div>
                        <h3 class="text-gray-400 text-sm font-medium">Total Orders</h3>
                        <p id="stat-orders" class="text-2xl font-bold text-white mt-1">...</p>
                    </div>
                    <!-- Stat 3 -->
                    <div class="glass-panel p-6 rounded-2xl stat-card transition-all duration-300">
                        <div class="flex justify-between items-start mb-4">
                            <div class="p-2 bg-purple-500/10 rounded-lg text-purple-500">
                                <span class="material-symbols-outlined">groups</span>
                            </div>
                            <span class="text-gray-500 text-xs font-bold">Today</span>
                        </div>
                        <h3 class="text-gray-400 text-sm font-medium">Active Guests</h3>
                        <p id="stat-guests" class="text-2xl font-bold text-white mt-1">...</p>
                    </div>
                    <!-- Stat 4 -->
                    <div class="glass-panel p-6 rounded-2xl stat-card transition-all duration-300">
                        <div class="flex justify-between items-start mb-4">
                            <div class="p-2 bg-orange-500/10 rounded-lg text-orange-500">
                                <span class="material-symbols-outlined">timelapse</span>
                            </div>
                            <span class="text-red-500 text-xs font-bold flex items-center">
                                -2m <span class="material-symbols-outlined text-[14px]">arrow_downward</span>
                            </span>
                        </div>
                        <h3 class="text-gray-400 text-sm font-medium">Avg. Prep Time</h3>
                        <p class="text-2xl font-bold text-white mt-1">18 min</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- LIVE KITCHEN (2/3 width) -->
                    <div class="lg:col-span-2 flex flex-col gap-6">
                        <!-- Chart Placeholder -->
                        <div class="glass-panel p-6 rounded-2xl border border-white/5">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-lg font-bold text-white">Revenue Analytics</h3>
                                <button
                                    class="text-xs bg-white/5 hover:bg-white/10 text-gray-300 px-3 py-1 rounded-md transition-colors">This
                                    Week</button>
                            </div>
                            <!-- Mock Chart Bars -->
                            <div class="h-64 flex items-end justify-between gap-2 px-2">
                                <div
                                    class="w-full bg-primary/20 rounded-t-sm hover:bg-primary/40 transition-all relative group h-[40%]">
                                </div>
                                <div
                                    class="w-full bg-primary/20 rounded-t-sm hover:bg-primary/40 transition-all relative group h-[60%]">
                                </div>
                                <div
                                    class="w-full bg-primary/20 rounded-t-sm hover:bg-primary/40 transition-all relative group h-[55%]">
                                </div>
                                <div
                                    class="w-full bg-primary/20 rounded-t-sm hover:bg-primary/40 transition-all relative group h-[75%]">
                                </div>
                                <div
                                    class="w-full bg-primary/20 rounded-t-sm hover:bg-primary/40 transition-all relative group h-[90%]">
                                </div>
                                <div
                                    class="w-full bg-primary rounded-t-sm shadow-[0_0_15px_rgba(201,162,77,0.4)] relative group h-[95%]">
                                </div>
                                <div
                                    class="w-full bg-primary/20 rounded-t-sm hover:bg-primary/40 transition-all relative group h-[85%]">
                                </div>
                            </div>
                            <div
                                class="flex justify-between mt-4 text-xs text-gray-500 font-medium uppercase tracking-wider">
                                <span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span
                                    class="text-primary">Sat</span><span>Sun</span>
                            </div>
                        </div>

                        <!-- Recent Orders Table -->
                        <div class="glass-panel rounded-2xl overflow-hidden border border-white/5">
                            <div class="p-6 border-b border-white/5 flex justify-between items-center">
                                <h3 class="text-lg font-bold text-white">Recent Orders</h3>
                                <a onclick="switchTab('orders')"
                                    class="text-primary text-sm hover:underline cursor-pointer">View All</a>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full text-left">
                                    <thead class="bg-white/5 text-gray-400 text-xs uppercase font-semibold">
                                        <tr>
                                            <th class="px-6 py-4">Order ID</th>
                                            <th class="px-6 py-4">Table</th>
                                            <th class="px-6 py-4">Items</th>
                                            <th class="px-6 py-4">Status</th>
                                            <th class="px-6 py-4 text-right">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recent-orders-body"
                                        class="divide-y divide-white/5 text-sm text-gray-300">
                                        <!-- JS Injected -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- RIGHT COLUMN -->
                    <div class="flex flex-col gap-6">
                        <!-- Kitchen Status -->
                        <div class="glass-panel p-6 rounded-2xl border border-white/5">
                            <h3 class="text-lg font-bold text-white mb-4">Kitchen Load</h3>
                            <div class="flex items-center gap-4 mb-6">
                                <div
                                    class="size-16 rounded-full border-4 border-primary/20 border-t-primary flex items-center justify-center animate-spin-slow">
                                    <span class="text-lg font-bold text-white animate-none"
                                        style="animation-direction: reverse;">78%</span>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-white">High Demand</p>
                                    <p class="text-xs text-gray-400">Est. delay: 15 mins</p>
                                </div>
                            </div>
                        </div>

                        <!-- Top Selling Items -->
                        <div class="glass-panel p-6 rounded-2xl border border-white/5 flex-1">
                            <h3 class="text-lg font-bold text-white mb-4">Trending Dishes</h3>
                            <div class="space-y-4">
                                <!-- Trending Item -->
                                <div class="flex items-center gap-3">
                                    <div class="size-10 rounded-lg bg-gray-800 overflow-hidden">
                                        <div class="w-full h-full bg-gray-700"></div>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-sm font-medium text-white">Truffle Pasta</p>
                                        <p class="text-xs text-gray-500">42 orders today</p>
                                    </div>
                                    <span class="text-sm font-bold text-white">₹850</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ================= VIEW: LIVE ORDERS (KANBAN) ================= -->
            <div id="view-orders" class="view-section">
                <!-- Kanban Board -->
                <div class="flex gap-4 h-[calc(100vh-140px)] overflow-x-auto pb-4">
                    <!-- Column: NEW -->
                    <div class="flex-shrink-0 w-80 flex flex-col bg-white/5 rounded-xl border border-white/5 h-full">
                        <div
                            class="p-4 border-b border-white/5 flex justify-between items-center bg-white/5 rounded-t-xl">
                            <h3 class="font-bold text-white flex items-center gap-2">
                                <span class="size-2 rounded-full bg-blue-500"></span> New Orders
                            </h3>
                            <span id="count-new" class="text-xs bg-bg-deep px-2 py-1 rounded text-gray-400">0</span>
                        </div>
                        <div id="col-new" class="p-3 flex-1 overflow-y-auto space-y-3">
                            <!-- JS Injected -->
                        </div>
                    </div>

                    <!-- Column: COOKING -->
                    <div class="flex-shrink-0 w-80 flex flex-col bg-white/5 rounded-xl border border-white/5 h-full">
                        <div
                            class="p-4 border-b border-white/5 flex justify-between items-center bg-white/5 rounded-t-xl">
                            <h3 class="font-bold text-white flex items-center gap-2">
                                <span class="size-2 rounded-full bg-yellow-500"></span> Cooking
                            </h3>
                            <span id="count-cooking" class="text-xs bg-bg-deep px-2 py-1 rounded text-gray-400">0</span>
                        </div>
                        <div id="col-cooking" class="p-3 flex-1 overflow-y-auto space-y-3">
                            <!-- JS Injected -->
                        </div>
                    </div>

                    <!-- Column: READY -->
                    <div class="flex-shrink-0 w-80 flex flex-col bg-white/5 rounded-xl border border-white/5 h-full">
                        <div
                            class="p-4 border-b border-white/5 flex justify-between items-center bg-white/5 rounded-t-xl">
                            <h3 class="font-bold text-white flex items-center gap-2">
                                <span class="size-2 rounded-full bg-green-500"></span> Ready
                            </h3>
                            <span id="count-ready" class="text-xs bg-bg-deep px-2 py-1 rounded text-gray-400">0</span>
                        </div>
                        <div id="col-ready" class="p-3 flex-1 overflow-y-auto space-y-3">
                            <!-- JS Injected -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- ================= VIEW: MENU MANAGEMENT ================= -->
            <div id="view-menu" class="view-section">
                <div class="flex justify-between items-center mb-6">
                    <div class="flex gap-4">
                        <button onclick="promptAddMenu()"
                            class="bg-primary text-black px-4 py-2 rounded-lg font-bold text-sm hover:bg-white transition-colors">Add
                            New Item</button>
                        <select
                            class="bg-bg-soft border border-white/10 rounded-lg px-4 py-2 text-sm text-gray-300 focus:outline-none focus:border-primary">
                            <option>All Categories</option>
                            <option>Main Course</option>
                            <option>Starters</option>
                            <option>Drinks</option>
                        </select>
                    </div>
                </div>

                <div id="menu-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- JS Injected -->
                </div>
            </div>

            <!-- ================= VIEW: TABLES ================= -->
            <div id="view-tables" class="view-section">
                <div class="flex gap-8">
                    <!-- Legend -->
                    <div class="w-64 flex-shrink-0 glass-panel p-6 rounded-xl h-fit">
                        <h3 class="font-bold text-white mb-4">Legend</h3>
                        <div class="space-y-3 text-sm">
                            <div class="flex items-center gap-3">
                                <span class="size-4 rounded bg-green-500/20 border border-green-500"></span>
                                <span class="text-gray-300">Available</span>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="size-4 rounded bg-red-500/20 border border-red-500"></span>
                                <span class="text-gray-300">Occupied</span>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="size-4 rounded bg-orange-500/20 border border-orange-500"></span>
                                <span class="text-gray-300">Reserved</span>
                            </div>
                        </div>
                        <div class="mt-8">
                            <h3 class="font-bold text-white mb-2">Quick Actions</h3>
                            <button onclick="showAlert('Reservation system coming soon!')"
                                class="w-full bg-white/5 hover:bg-white/10 text-gray-300 text-sm py-2 rounded mb-2">Create
                                Reservation</button>
                            <button onclick="showAlert('Select two adjacent tables to merge.')"
                                class="w-full bg-white/5 hover:bg-white/10 text-gray-300 text-sm py-2 rounded">Merge
                                Tables</button>
                        </div>
                    </div>

                    <!-- Layout Grid -->
                    <div class="flex-1 glass-panel p-8 rounded-xl min-h-[600px] relative bg-grid-pattern">
                        <!-- Zones Title (Absolute for visuals) -->
                        <div class="absolute top-4 left-8 text-gray-500 font-bold uppercase tracking-widest text-xs">
                            Main Dining Hall</div>

                        <div class="grid grid-cols-4 gap-12 mt-8">
                            <!-- Table: Occupied -->
                            <div onclick="handleTableClick('T-01')"
                                class="aspect-square bg-red-500/10 border-2 border-red-500 rounded-2xl flex flex-col items-center justify-center relative cursor-pointer hover:bg-red-500/20 transition-colors">
                                <span class="text-2xl font-bold text-red-500">T-01</span>
                                <span class="text-xs text-red-400 mt-1">Occupied</span>
                            </div>
                            <!-- Table: Free -->
                            <div onclick="handleTableClick('T-02')"
                                class="aspect-square bg-green-500/10 border-2 border-green-500 rounded-2xl flex flex-col items-center justify-center relative cursor-pointer hover:bg-green-500/20 transition-colors">
                                <span class="text-2xl font-bold text-green-500">T-02</span>
                                <span class="text-xs text-green-400 mt-1">Empty</span>
                            </div>
                            <!-- Table: Reserved -->
                            <div onclick="handleTableClick('T-03')"
                                class="aspect-square bg-orange-500/10 border-2 border-orange-500 rounded-2xl flex flex-col items-center justify-center relative cursor-pointer hover:bg-orange-500/20 transition-colors">
                                <span class="text-2xl font-bold text-orange-500">T-03</span>
                                <span class="text-xs text-orange-400 mt-1">Reserved</span>
                            </div>
                            <!-- Table: Occupied -->
                            <div onclick="handleTableClick('T-04')"
                                class="aspect-square bg-red-500/10 border-2 border-red-500 rounded-2xl flex flex-col items-center justify-center relative cursor-pointer hover:bg-red-500/20 transition-colors">
                                <span class="text-2xl font-bold text-red-500">T-04</span>
                                <span class="text-xs text-red-400 mt-1">Occupied</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ================= VIEW: REPORTS ================= -->
            <div id="view-reports" class="view-section">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                    <div class="glass-panel p-6 rounded-xl">
                        <h3 class="font-bold text-white mb-4">Weekly Sales</h3>
                        <!-- Pure CSS Bar Chart (Mock) -->
                        <div class="flex items-end justify-between h-64 gap-2 pt-4 border-t border-white/5">
                            <div
                                class="w-full bg-primary h-[40%] rounded-t opacity-50 hover:opacity-100 transition-opacity relative group">
                            </div>
                            <div
                                class="w-full bg-primary h-[60%] rounded-t opacity-50 hover:opacity-100 transition-opacity relative group">
                            </div>
                            <div
                                class="w-full bg-primary h-[45%] rounded-t opacity-50 hover:opacity-100 transition-opacity relative group">
                            </div>
                            <div
                                class="w-full bg-primary h-[80%] rounded-t opacity-50 hover:opacity-100 transition-opacity relative group">
                            </div>
                            <div
                                class="w-full bg-primary h-[90%] rounded-t opacity-50 hover:opacity-100 transition-opacity relative group">
                            </div>
                            <div class="w-full bg-primary h-[100%] rounded-t shadow-[0_0_20px_#c9a24d] relative group">
                            </div>
                            <div
                                class="w-full bg-primary h-[70%] rounded-t opacity-50 hover:opacity-100 transition-opacity relative group">
                            </div>
                        </div>
                        <div class="flex justify-between text-xs text-gray-500 mt-2 font-mono">
                            <span>M</span><span>T</span><span>W</span><span>T</span><span>F</span><span>S</span><span>S</span>
                        </div>
                    </div>
                    <div class="glass-panel p-6 rounded-xl">
                        <h3 class="font-bold text-white mb-4">Order Sources</h3>
                        <div class="flex items-center justify-center h-64">
                            <!-- Simple CSS Pie Chart representation -->
                            <div
                                class="size-48 rounded-full border-[16px] border-primary border-r-transparent border-b-primary/30 flex items-center justify-center">
                                <div class="text-center">
                                    <span class="block text-2xl font-bold text-white">Total</span>
                                    <span class="text-sm text-gray-500">1,432</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ================= VIEW: TRANSACTIONS ================= -->
            <div id="view-transactions" class="view-section">
                <div class="glass-panel rounded-xl overflow-hidden border border-white/5">
                    <div class="p-6 border-b border-white/5">
                        <h3 class="font-bold text-white">Transaction History</h3>
                    </div>
                    <table class="w-full text-left text-sm text-gray-400">
                        <thead class="bg-white/5 uppercase text-xs">
                            <tr>
                                <th class="px-6 py-4">Transaction ID</th>
                                <th class="px-6 py-4">Date</th>
                                <th class="px-6 py-4">Method</th>
                                <th class="px-6 py-4">Status</th>
                                <th class="px-6 py-4 text-right">Amount</th>
                            </tr>
                        </thead>
                        </td>
                        <td class="px-6 py-4 text-right text-white">₹2,400</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 text-white font-mono">TXN_883920</td>
                            <td class="px-6 py-4">Dec 17, 07:05 PM</td>
                            <td class="px-6 py-4 flex items-center gap-2"><span
                                    class="material-symbols-outlined text-sm">phone_iphone</span> UPI</td>
                            <td class="px-6 py-4"><span
                                    class="text-green-500 text-xs border border-green-500/30 bg-green-500/10 px-2 py-0.5 rounded">Success</span>
                            </td>
                            <td class="px-6 py-4 text-right text-white">₹850</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 text-white font-mono">TXN_883919</td>
                            <td class="px-6 py-4">Dec 17, 06:45 PM</td>
                            <td class="px-6 py-4 flex items-center gap-2"><span
                                    class="material-symbols-outlined text-sm">payments</span> Cash</td>
                            <td class="px-6 py-4"><span
                                    class="text-green-500 text-xs border border-green-500/30 bg-green-500/10 px-2 py-0.5 rounded">Success</span>
                            </td>
                            <td class="px-6 py-4 text-right text-white">₹1,200</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 text-white font-mono opacity-50">TXN_883918</td>
                            <td class="px-6 py-4 opacity-50">Dec 17, 06:30 PM</td>
                            <td class="px-6 py-4 flex items-center gap-2 opacity-50"><span
                                    class="material-symbols-outlined text-sm">credit_card</span> Mastercard</td>
                            <td class="px-6 py-4"><span
                                    class="text-red-500 text-xs border border-red-500/30 bg-red-500/10 px-2 py-0.5 rounded">Failed</span>
                            </td>
                            <td class="px-6 py-4 text-right text-white opacity-50">₹3,500</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
        <!-- GENERIC MODAL -->
        <div id="generic-modal" class="fixed inset-0 z-[100] hidden">
            <!-- Backdrop -->
            <div class="absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity opacity-0" id="modal-backdrop">
            </div>
            <!-- Content -->
            <div class="absolute inset-0 flex items-center justify-center p-4 z-10 pointer-events-none">
                <div id="modal-panel"
                    class="bg-[#1a1a1a] border border-white/10 rounded-2xl w-full max-w-md transform scale-95 opacity-0 transition-all duration-300 shadow-2xl relative overflow-hidden pointer-events-auto">
                    <!-- Header -->
                    <div class="px-6 py-4 border-b border-white/5 flex justify-between items-center bg-white/5">
                        <h3 id="modal-title" class="text-lg font-bold text-white tracking-tight">Modal Title</h3>
                        <button onclick="closeModal()" class="text-gray-400 hover:text-white transition-colors">
                            <span class="material-symbols-outlined">close</span>
                        </button>
                    </div>
                    <!-- Body -->
                    <div class="p-6 space-y-4" id="modal-body">
                        <!-- Dynamic Inputs -->
                    </div>
                    <!-- Footer -->
                    <div class="px-6 py-4 border-t border-white/5 flex justify-end gap-3 bg-white/5">
                        <button onclick="closeModal()"
                            class="px-4 py-2 text-xs font-bold text-gray-400 hover:text-white transition-colors">Cancel</button>
                        <button id="modal-submit-btn"
                            class="bg-primary text-black px-6 py-2 rounded text-xs font-bold hover:bg-white transition-colors shadow-lg shadow-primary/20 cursor-pointer">Submit</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- NOTIFICATION TOAST (New Addition for feedback) -->
        <div id="toast-container" class="fixed bottom-8 right-8 z-50 flex flex-col gap-2"></div>
    </main>

    <script>
        // --- AUTHENTICATION & DATA ISOLATION ---
        const userSession = localStorage.getItem('user');
        let currentUser = null;

        try {
            currentUser = JSON.parse(userSession);
        } catch (e) {
            console.error("Invalid session");
        }

        if (!currentUser || !currentUser.id) {
            window.location.href = "../Final-login-Page/index.html"; // Redirect to login
        }

        // Global Fetch Interceptor to inject JWT Token (Standard Auth)
        const originalFetch = window.fetch;
        window.fetch = function (url, options = {}) {
            const token = localStorage.getItem('token');
            options.headers = options.headers || {};

            if (token) {
                if (options.headers instanceof Headers) {
                    options.headers.set('Authorization', `Bearer ${token}`);
                } else {
                    options.headers['Authorization'] = `Bearer ${token}`;
                }
            }

            return originalFetch(url, options);
        };

        // Update Profile Info in UI
        document.addEventListener("DOMContentLoaded", () => {
            const nameEl = document.querySelector(".text-right .text-sm");
            const roleEl = document.querySelector(".text-right .text-xs");
            // Also update avatar name if possible
            const avatarImg = document.querySelector("img[src*='ui-avatars']");

            if (nameEl) nameEl.textContent = currentUser.name || "User";
            if (roleEl) roleEl.textContent = currentUser.role || "Owner";
            if (avatarImg) {
                avatarImg.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.name)}&background=0b0b0b&color=fff`;
            }
        });


        function switchTab(tabId) {
            // 1. Hide all views
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));

            // 2. Show active view
            const activeView = document.getElementById('view-' + tabId);
            if (activeView) activeView.classList.add('active');

            // 3. Update Sidebar Active State
            document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active'));
            document.getElementById('nav-' + tabId).classList.add('active');

            // 4. Update Header Title
            const titles = {
                'dashboard': 'Overview',
                'orders': 'Live Kitchen Board',
                'menu': 'Menu Management',
                'tables': 'Floor Plan & Zones',
                'reports': 'Sales Analytics',
                'transactions': 'Transaction History'
            };
            document.getElementById('page-title').textContent = titles[tabId] || 'Dashboard';
        }

        // Fetch Stats
        async function fetchStats() {
            try {
                const res = await fetch("/api/v1/stats/dashboard");
                const data = await res.json();

                if (document.getElementById("stat-revenue"))
                    document.getElementById("stat-revenue").textContent = "₹" + data.revenue.toLocaleString();
                if (document.getElementById("stat-orders"))
                    document.getElementById("stat-orders").textContent = data.orders;
                if (document.getElementById("stat-guests"))
                    document.getElementById("stat-guests").textContent = data.active_guests;
            } catch (err) {
                console.error("Failed to load stats", err);
            }
        }

        // Fetch Orders
        async function fetchOrders() {
            try {
                const res = await fetch("/api/v1/orders");
                const orders = await res.json();

                // Clear Cols
                const newCol = document.getElementById("col-new");
                const cookCol = document.getElementById("col-cooking");
                const readyCol = document.getElementById("col-ready");
                if (newCol) newCol.innerHTML = '';
                if (cookCol) cookCol.innerHTML = '';
                if (readyCol) readyCol.innerHTML = '';

                let cNew = 0, cCook = 0, cReady = 0;

                orders.forEach(order => {
                    const card = document.createElement("div");
                    card.className = "glass-panel p-4 rounded-lg border border-white/10 hover:border-primary/50 transition-colors cursor-grab active:cursor-grabbing";

                    let itemsHtml = order.items.map(i => `<p>${i.qty}x ${i.name}</p>`).join('');
                    let actionBtn = '';
                    let targetCol = null;

                    if (order.status === 'New') {
                        cNew++;
                        targetCol = newCol;
                        actionBtn = `<button onclick="updateStatus(${order.id}, 'Cooking')" class="text-primary hover:text-white">Start Cooking</button>`;
                    } else if (order.status === 'Cooking') {
                        cCook++;
                        targetCol = cookCol;
                        actionBtn = `<button onclick="updateStatus(${order.id}, 'Ready')" class="text-primary hover:text-white">Mark Ready</button>`;
                    } else if (order.status === 'Ready') {
                        cReady++;
                        targetCol = readyCol;
                        actionBtn = `<button onclick="updateStatus(${order.id}, 'Served')" class="bg-green-600 text-white px-3 py-1 rounded hover:bg-green-500">Serve</button>`;
                    }

                    if (targetCol) {
                        card.innerHTML = `
                            <div class="flex justify-between mb-2">
                                <span class="font-bold text-white">#ORD-${order.id}</span>
                                <span class="text-xs text-gray-400">${new Date(order.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</span>
                            </div>
                            <div class="text-sm text-gray-300 mb-3">${itemsHtml}</div>
                            <div class="flex justify-between items-center text-xs">
                                <span class="bg-blue-500/10 text-blue-400 px-2 py-1 rounded">${order.table_no}</span>
                                ${actionBtn}
                            </div>
                        `;
                        targetCol.appendChild(card);
                    }
                });

                if (document.getElementById('count-new')) document.getElementById('count-new').textContent = cNew;
                if (document.getElementById('count-cooking')) document.getElementById('count-cooking').textContent = cCook;
                if (document.getElementById('count-ready')) document.getElementById('count-ready').textContent = cReady;

            } catch (err) { console.error("Failed to fetch orders", err); }
        }

        async function updateStatus(id, status) {
            try {
                await fetch(`/api/v1/orders/${id}/status`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ status })
                });
                fetchOrders(); // Refresh
                fetchStats();
            } catch (err) { console.error(err); }
        }

        // Fetch Menu
        async function fetchMenu() {
            try {
                const res = await fetch("/api/v1/menu");
                const menu = await res.json();
                const grid = document.getElementById("menu-grid");
                if (grid) {
                    grid.innerHTML = '';
                    menu.forEach(item => {
                        const isPending = item.status === 'pending';
                        // Image Handling
                        let imageHtml = `<div class="w-full h-full bg-gray-700 flex items-center justify-center text-gray-400 font-bold text-xl">${item.name[0]}</div>`;
                        if (item.image_url && item.image_url.startsWith('data:image')) {
                            imageHtml = `<img src="${item.image_url}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">`;
                        }

                        grid.innerHTML += `
                        <div class="glass-panel rounded-xl overflow-hidden group ${isPending ? 'border border-yellow-500/50' : ''} relative">
                            ${isPending ? '<div class="absolute top-2 left-2 z-10 bg-yellow-500 text-black text-[10px] font-bold px-2 py-0.5 rounded">PENDING APPROVAL</div>' : ''}
                            <div class="h-40 bg-gray-800 relative overflow-hidden">
                                ${imageHtml}
                                <div class="absolute top-2 right-2 bg-black/60 backdrop-blur px-2 py-1 rounded text-xs text-white font-bold">₹${item.price}</div>
                            </div>
                            <div class="p-4">
                                <div class="flex justify-between items-start mb-2">
                                    <h3 class="font-bold text-white text-md">${item.name}</h3>
                                    ${!isPending ? `
                                    <div class="relative inline-block w-8 h-4 align-middle select-none transition duration-200 ease-in">
                                        <input type="checkbox" ${item.available ? 'checked' : ''} class="toggle-checkbox absolute block w-4 h-4 rounded-full bg-white border-4 appearance-none cursor-pointer ${item.available ? 'bg-primary right-0' : 'bg-gray-500 right-4'}"/>
                                    </div>` : ''}
                                </div>
                                <p class="text-xs text-gray-500 line-clamp-2 mb-4">${item.category}</p>
                                <div class="flex gap-2">
                                    <button class="flex-1 border border-white/10 py-1.5 rounded hover:bg-white/5 text-xs text-gray-300" ${isPending ? 'disabled' : ''}>Edit</button>
                                    <button onclick="deleteMenu(${item.id})" class="flex-1 border border-red-500/30 py-1.5 rounded hover:bg-red-500/10 text-xs text-red-500">Delete</button>
                                </div>
                            </div>
                        </div>`;
                    });
                }
            } catch (err) { console.error("Failed to fetch menu", err); }
        }

        async function deleteMenu(id) {
            if (!await showConfirm("Are you sure you want to delete this menu item?")) return;
            await fetch(`/api/v1/menu/${id}`, { method: 'DELETE' });
            fetchMenu();
        }

        function showConfirm(message) {
            return new Promise((resolve) => {
                const modal = document.getElementById('generic-modal');
                const titleEl = document.getElementById('modal-title');
                const bodyEl = document.getElementById('modal-body');
                const submitBtn = document.getElementById('modal-submit-btn');
                const backdrop = document.getElementById('modal-backdrop');
                const panel = document.getElementById('modal-panel');

                // Reset modal appearance for Confirm
                titleEl.textContent = "Confirm Action";
                bodyEl.innerHTML = `<div class="py-4 text-center"><p class="text-gray-300">${message}</p></div>`;
                submitBtn.textContent = "Confirm";

                // Show modal
                modal.classList.remove('hidden');
                setTimeout(() => {
                    backdrop.classList.remove('opacity-0');
                    panel.classList.remove('opacity-0', 'scale-95');
                }, 10);

                // Bind submit
                submitBtn.onclick = () => closeModal(true);
                currentModalResolve = resolve;
            });
        }

        function showAlert(message) {
            return new Promise((resolve) => {
                const modal = document.getElementById('generic-modal');
                const titleEl = document.getElementById('modal-title');
                const bodyEl = document.getElementById('modal-body');
                const submitBtn = document.getElementById('modal-submit-btn');
                const backdrop = document.getElementById('modal-backdrop');
                const panel = document.getElementById('modal-panel');

                // Reset modal appearance for Alert
                titleEl.textContent = "Notification";
                bodyEl.innerHTML = `<div class="py-4 text-center"><p class="text-gray-300">${message}</p></div>`;
                submitBtn.textContent = "Understood";

                // Show modal
                modal.classList.remove('hidden');
                setTimeout(() => {
                    backdrop.classList.remove('opacity-0');
                    panel.classList.remove('opacity-0', 'scale-95');
                }, 10);

                // Re-bind submit to just close
                submitBtn.onclick = () => closeModal(true);
                currentModalResolve = resolve;
            });
        }

        // --- MODAL SYSTEM ---
        let currentModalResolve = null;

        function openModal({ title, fields, submitLabel = 'Create' }) {
            return new Promise((resolve) => {
                const modal = document.getElementById('generic-modal');
                const backdrop = document.getElementById('modal-backdrop');
                const panel = document.getElementById('modal-panel');
                const titleEl = document.getElementById('modal-title');
                const bodyEl = document.getElementById('modal-body');
                const submitBtn = document.getElementById('modal-submit-btn');

                // Set Content
                titleEl.textContent = title;
                submitBtn.textContent = submitLabel;
                bodyEl.innerHTML = '';

                // Generate Fields
                fields.forEach(field => {
                    const div = document.createElement('div');
                    // CHECK FOR DEFAULT VALUE
                    const valueAttr = field.defaultValue ? `value="${field.defaultValue}"` : '';

                    div.innerHTML = `
                <label class="block text-xs uppercase tracking-wider text-gray-500 mb-1 font-semibold">${field.label}</label>
                ${field.type === 'select' ?
                            `<select name="${field.name}" class="w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-sm text-white focus:outline-none focus:border-primary transition-colors">
                        ${field.options.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
                    </select>` :
                            `<input type="${field.type}" name="${field.name}" placeholder="${field.placeholder || ''}" ${valueAttr}
                        class="w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-sm text-white focus:outline-none focus:border-primary transition-colors placeholder-gray-600">`
                        }
            `;
                    bodyEl.appendChild(div);
                });

                // Show Modal (Animation)
                modal.classList.remove('hidden');
                // Trigger reflow
                void modal.offsetWidth;
                backdrop.classList.remove('opacity-0');
                panel.classList.remove('opacity-0', 'scale-95');

                // Handle Submit Logic
                const handleSubmit = () => {
                    const formData = {};
                    const inputs = bodyEl.querySelectorAll('input, select');
                    let valid = true;
                    inputs.forEach(input => {
                        // Allow empty if not required (custom logic if needed, but for now strict)
                        if (!input.value) valid = false;
                        formData[input.name] = input.value;
                    });

                    if (valid) {
                        closeModal(formData);
                    } else {
                        // Shake animation for error
                        panel.classList.add('animate-pulse');
                        setTimeout(() => panel.classList.remove('animate-pulse'), 500);
                    }
                };

                submitBtn.onclick = handleSubmit;

                // Handle Enter Key on Inputs
                const inputs = bodyEl.querySelectorAll('input');
                inputs.forEach(input => {
                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter') {
                            e.preventDefault();
                            handleSubmit();
                        }
                    });
                });

                // Focus first input
                if (inputs.length > 0) inputs[0].focus();

                currentModalResolve = resolve;
            });
        }

        function closeModal(result = null) {
            const modal = document.getElementById('generic-modal');
            const backdrop = document.getElementById('modal-backdrop');
            const panel = document.getElementById('modal-panel');

            backdrop.classList.add('opacity-0');
            panel.classList.add('opacity-0', 'scale-95');

            setTimeout(() => {
                modal.classList.add('hidden');
                if (currentModalResolve) {
                    currentModalResolve(result);
                    currentModalResolve = null;
                }
            }, 300);
        }

        // Add Menu (Replaced Alert)
        async function promptAddMenu() {
            const data = await openModal({
                title: 'Add New Menu Item',
                fields: [
                    { name: 'name', label: 'Item Name', type: 'text', placeholder: 'e.g. Truffle Pizza' },
                    { name: 'category', label: 'Category', type: 'select', options: ['Main', 'Starter', 'Dessert', 'Drink'] },
                    { name: 'price', label: 'Price (₹)', type: 'number', placeholder: 'e.g. 450' }
                ],
                submitLabel: 'Submit Request'
            });

            if (!data) return;

            const price = parseFloat(data.price) || 0;
            if (price <= 0) return showAlert("Invalid Price");

            try {
                const res = await fetch("/api/v1/menu", {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: data.name,
                        category: data.category || 'Main',
                        price: price,
                        image_url: ""
                    })
                });
                const resData = await res.json();
                if (resData.success) {
                    showAlert("Item submitted for approval! It will appear once approved by Admin.");
                    fetchMenu();
                } else {
                    showAlert("Failed to add item");
                }
            } catch (e) {
                console.error(e);
                showAlert("Error adding item");
            }
        }
        // Fetch Reports (Sales Chart)
        async function fetchReports() {
            try {
                const res = await fetch("/api/v1/stats/reports");
                const data = await res.json();

                // Update Bar Chart
                const chartContainer = document.querySelector("#view-reports .flex.items-end");
                if (chartContainer && data.weekly) {
                    const maxVal = Math.max(...data.weekly.map(d => d.total)) || 1000;

                    chartContainer.innerHTML = data.weekly.map(day => `
                        <div class="w-full bg-primary rounded-t relative group transition-all duration-500 hover:opacity-100 opacity-80" 
                             style="height: ${Math.max((day.total / maxVal) * 100, 5)}%">
                             <div class="absolute -top-8 left-1/2 -translate-x-1/2 bg-black text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity">₹${day.total}</div>
                        </div>
                    `).join('');

                    // Update Labels
                    const labelsContainer = document.querySelector("#view-reports .flex.justify-between.text-xs");
                    if (labelsContainer) {
                        labelsContainer.innerHTML = data.weekly.map(d => `<span>${d.day}</span>`).join('');
                    }
                }
            } catch (e) { console.error("Reports error", e); }
        }

        // Fetch Transactions
        async function fetchTransactions() {
            try {
                // Transactions usually mapped to Served/Paid orders in our simplified schema
                const res = await fetch("/api/v1/orders");
                let data = await res.json();
                data = data.filter(o => o.status === 'Served' || o.status === 'Paid');

                const tbody = document.querySelector("#view-transactions tbody");
                if (tbody && data.length > 0) {
                    tbody.innerHTML = data.map(txn => `
                        <tr>
                            <td class="px-6 py-4 text-white font-mono">#TXN-${txn.id}</td>
                            <td class="px-6 py-4">${new Date(txn.timestamp).toLocaleString()}</td>
                            <td class="px-6 py-4 flex items-center gap-2">
                                <span class="material-symbols-outlined text-sm">payments</span> Cash
                            </td>
                            <td class="px-6 py-4">
                                <span class="text-green-500 text-xs border border-green-500/30 bg-green-500/10 px-2 py-0.5 rounded">${txn.status}</span>
                            </td>
                            <td class="px-6 py-4 text-right text-white">₹${txn.total}</td>
                        </tr>
                    `).join('');
                }
            } catch (e) { console.error("Txn error", e); }
        }

        async function handleTableClick(tableId) {
            try {
                // 1. Check if occupied
                const res = await fetch("/api/v1/orders");
                const orders = await res.json();
                const activeOrder = orders.find(o => o.table_no === tableId && ['New', 'Cooking', 'Ready'].includes(o.status));

                if (activeOrder) {
                    showAlert(`Table ${tableId} is OCCUPIED.\n\nOrder #${activeOrder.id}\nStatus: ${activeOrder.status}\nTotal: ₹${activeOrder.total}`);
                } else {
                    // 2. New Order Flow
                    // Fetch Menu for Select dropdown
                    const menuRes = await fetch("/api/v1/menu");
                    const menuData = await menuRes.json();

                    // Filter out PENDING items - Owner cannot take order until approved
                    const availableItems = menuData.filter(m => m.status !== 'pending');

                    // Create formatted options: "Item Name | ₹Price"
                    const menuOptions = availableItems.map(m => `${m.name} | ₹${m.price}`);

                    if (menuOptions.length === 0) {
                        return showAlert("No approved menu items available. Please wait for Admin approval.");
                    }

                    const data = await openModal({
                        title: `New Order for ${tableId}`,
                        fields: [
                            { name: 'itemStr', label: 'Select Item', type: 'select', options: menuOptions },
                            { name: 'qty', label: 'Quantity', type: 'number', placeholder: '1', defaultValue: '1' }
                        ],
                        submitLabel: 'Place Order'
                    });

                    if (!data) return;

                    // Parse selection
                    // "Item Name | ₹Price" -> split
                    const [namePart, pricePart] = data.itemStr.split(' | ₹');
                    const itemName = namePart.trim();
                    const itemPrice = parseFloat(pricePart);
                    const qty = parseInt(data.qty) || 1;

                    const total = itemPrice * qty;

                    await fetch("/api/v1/orders", {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            table_no: tableId,
                            items: [{ name: itemName, qty: qty, price: itemPrice }],
                            total: total
                        })
                    });

                    // Show confirmation?
                    // alert("Order Placed!"); // Optional, maybe too noisy
                    fetchOrders();
                    fetchTables();
                    fetchStats();
                    fetchRecentOrders();
                }
            } catch (e) {
                console.error(e);
                showAlert("Error handling table interaction");
            }
        }

        async function fetchRecentOrders() {
            try {
                const res = await fetch("/api/v1/orders");
                const orders = await res.json();
                const tbody = document.getElementById("recent-orders-body");

                if (tbody) {
                    // Take top 5
                    const recent = orders.slice(0, 5);
                    tbody.innerHTML = recent.map(o => {
                        let statusColor = 'bg-gray-500/10 text-gray-500';
                        if (o.status === 'New') statusColor = 'bg-blue-500/10 text-blue-500';
                        if (o.status === 'Cooking') statusColor = 'bg-yellow-500/10 text-yellow-500';
                        if (o.status === 'Ready') statusColor = 'bg-green-500/10 text-green-500';

                        // Items summary
                        const itemsSummary = o.items.map(i => i.name).join(', ');

                        return `
                        <tr class="hover:bg-white/5 transition-colors group cursor-pointer">
                            <td class="px-6 py-4 font-medium text-white">#ORD-${o.id}</td>
                            <td class="px-6 py-4">${o.table_no}</td>
                            <td class="px-6 py-4 truncate max-w-xs">${itemsSummary}</td>
                            <td class="px-6 py-4"><span class="px-2 py-1 rounded-full text-xs font-bold border border-white/5 ${statusColor}">${o.status}</span></td>
                            <td class="px-6 py-4 text-right font-bold text-white">₹${o.total}</td>
                        </tr>
                        `;
                    }).join('');
                }
            } catch (e) { console.error(e); }
        }

        // Fetch & Update Tables Status
        async function fetchTables() {
            try {
                // We infer status from Active Orders
                const res = await fetch("/api/v1/orders");
                const orders = await res.json();

                // Get all active tables from orders (New, Cooking, Ready)
                const activeTables = new Set(orders.filter(o => ['New', 'Cooking', 'Ready'].includes(o.status)).map(o => o.table_no));

                document.querySelectorAll('#view-tables .aspect-square').forEach(el => {
                    const title = el.querySelector('.font-bold');
                    if (title) {
                        const tableId = title.textContent.trim();
                        if (activeTables.has(tableId)) {
                            // Set to Occupied (Red)
                            el.className = "aspect-square bg-red-500/10 border-2 border-red-500 rounded-2xl flex flex-col items-center justify-center relative cursor-pointer hover:bg-red-500/20 transition-colors";
                            if (title) title.className = "text-2xl font-bold text-red-500";
                            // Add/Update label
                            let label = el.querySelector('.text-xs');
                            if (!label) {
                                label = document.createElement('span');
                                label.className = "text-xs text-red-400 mt-1";
                                el.appendChild(label);
                            }
                            label.className = "text-xs text-red-400 mt-1";
                            label.textContent = "Occupied";

                        } else {
                            // Set to Free (Green)
                            el.className = "aspect-square bg-green-500/10 border-2 border-green-500 rounded-2xl flex flex-col items-center justify-center relative cursor-pointer hover:bg-green-500/20 transition-colors";
                            if (title) title.className = "text-2xl font-bold text-green-500";
                            let label = el.querySelector('.text-xs');
                            if (!label) {
                                label = document.createElement('span');
                                label.className = "text-xs text-green-400 mt-1";
                                el.appendChild(label);
                            }
                            label.className = "text-xs text-green-400 mt-1";
                            label.textContent = "Empty";
                        }
                    }
                });
            } catch (e) { console.error("Tables error", e); }
        }

        document.addEventListener("DOMContentLoaded", () => {
            fetchStats();
            fetchOrders();
            fetchMenu();
            fetchReports();
            fetchTransactions();
            fetchTables();
            fetchRecentOrders();
            // Poll
            setInterval(() => {
                fetchOrders();
                fetchTables();
                fetchStats();
                fetchRecentOrders();
                fetchTransactions();
                fetchReports();
            }, 3000);
        });
    </script>
</body>

</html>